<div class="onboarding-container" data-controller="onboarding">
  <!-- Header avec progression -->
  <div class="onboarding-header">
    <div class="onboarding-logo">
      <i class="bi bi-moon-stars-fill"></i>
      <span>DreamCatcher</span>
    </div>
    <div class="onboarding-progress-container">
      <div class="onboarding-progress-bar">
        <div class="onboarding-progress-fill" data-onboarding-target="progress"></div>
      </div>
      <span class="onboarding-progress-text" data-onboarding-target="progressText">√âtape 1 sur 6</span>
    </div>
  </div>

  <%= form_with model: @user, url: quiz_path, method: :post, class: "onboarding-form", data: { turbo: false } do |f| %>

    <!-- √âTAPE 1: Informations personnelles -->
    <div class="onboarding-step active" data-onboarding-target="step">
      <div class="step-icon">
        <i class="bi bi-person-heart"></i>
      </div>
      <h2 class="step-title">Faisons connaissance</h2>
      <p class="step-subtitle">Quelques informations pour personnaliser votre exp√©rience</p>

      <div class="step-content">
        <div class="form-group">
          <label class="onboarding-label">Quel est votre pr√©nom ?</label>
          <%= f.text_field :first_name, class: "onboarding-input", placeholder: "Votre pr√©nom...", required: true %>
        </div>

        <div class="form-group">
          <label class="onboarding-label">Quel est votre √¢ge ?</label>
          <%= f.number_field :age, class: "onboarding-input", placeholder: "Votre √¢ge...", min: 1, max: 120, required: true %>
        </div>

        <div class="form-group">
          <label class="onboarding-label">Quel est votre genre ?</label>
          <div class="options-container" data-multiple="false">
            <%= f.hidden_field :gender %>
            <% User::GENRES.each do |genre| %>
              <button type="button" class="option-btn" data-value="<%= genre %>" data-action="click->onboarding#selectOption">
                <%= genre %>
              </button>
            <% end %>
          </div>
        </div>

        <div class="form-group">
          <label class="onboarding-label">Dans quel pays vivez-vous ?</label>
          <%= f.text_field :pays, class: "onboarding-input", placeholder: "France, Belgique, Suisse..." %>
        </div>

        <div class="form-group">
          <label class="onboarding-label">Quel est votre signe astrologique ?</label>
          <div class="options-container zodiac-options" data-multiple="false">
            <%= f.hidden_field :zodiac_sign %>
            <% User::SIGNES_ASTRO.each_with_index do |signe, i| %>
              <% icons = ["‚ôà", "‚ôâ", "‚ôä", "‚ôã", "‚ôå", "‚ôç", "‚ôé", "‚ôè", "‚ôê", "‚ôë", "‚ôí", "‚ôì"] %>
              <button type="button" class="option-btn zodiac-btn" data-value="<%= signe %>" data-action="click->onboarding#selectOption">
                <span class="zodiac-icon"><%= icons[i] %></span>
                <span class="zodiac-name"><%= signe %></span>
              </button>
            <% end %>
          </div>
        </div>
      </div>
    </div>

    <!-- √âTAPE 2: Sommeil et r√™ves -->
    <div class="onboarding-step d-none" data-onboarding-target="step">
      <div class="step-icon">
        <i class="bi bi-cloud-moon"></i>
      </div>
      <h2 class="step-title">Vos habitudes de sommeil</h2>
      <p class="step-subtitle">Parlez-nous de votre rapport aux r√™ves</p>

      <div class="step-content">
        <div class="form-group">
          <label class="onboarding-label">√Ä quelle fr√©quence vous souvenez-vous de vos r√™ves ?</label>
          <div class="options-container" data-multiple="false">
            <%= f.hidden_field :rappel_reves %>
            <% User::RAPPEL_REVES.each do |option| %>
              <button type="button" class="option-btn" data-value="<%= option %>" data-action="click->onboarding#selectOption">
                <%= option %>
              </button>
            <% end %>
          </div>
        </div>

        <div class="form-group">
          <label class="onboarding-label">Avez-vous des r√™ves lucides ?</label>
          <div class="options-container" data-multiple="false">
            <%= f.hidden_field :reves_lucides %>
            <% User::REVES_LUCIDES.each do |option| %>
              <button type="button" class="option-btn" data-value="<%= option %>" data-action="click->onboarding#selectOption">
                <%= option %>
              </button>
            <% end %>
          </div>
        </div>

        <div class="form-group">
          <label class="onboarding-label">√Ä quelle heure vous couchez-vous en moyenne ?</label>
          <%= f.text_field :heure_sommeil, class: "onboarding-input", placeholder: "Ex: 23h00, minuit..." %>
        </div>
      </div>
    </div>

    <!-- √âTAPE 3: Contexte √©motionnel -->
    <div class="onboarding-step d-none" data-onboarding-target="step">
      <div class="step-icon">
        <i class="bi bi-heart-pulse"></i>
      </div>
      <h2 class="step-title">Votre √©tat √©motionnel</h2>
      <p class="step-subtitle">Ces informations nous aident √† contextualiser vos r√™ves</p>

      <div class="step-content">
        <div class="form-group">
          <label class="onboarding-label">Quel est votre niveau de stress actuel ? (1 √† 10)</label>
          <div class="stress-slider">
            <%= f.range_field :stress_niveau, min: 1, max: 10, value: 5, class: "onboarding-range", data: { action: "input->onboarding#updateRangeValue" } %>
            <div class="stress-labels">
              <span>üòå Zen</span>
              <span>üò∞ Stress√©</span>
            </div>
          </div>
        </div>

        <div class="form-group">
          <label class="onboarding-label">Comment d√©cririez-vous votre humeur g√©n√©rale ces derni√®res semaines ?</label>
          <div class="options-container" data-multiple="false">
            <%= f.hidden_field :humeur_generale %>
            <% User::HUMEUR_OPTIONS.each do |option| %>
              <button type="button" class="option-btn" data-value="<%= option %>" data-action="click->onboarding#selectOption">
                <%= option %>
              </button>
            <% end %>
          </div>
        </div>

        <div class="form-group">
          <label class="onboarding-label">Quelles sont vos principales sources de stress actuelles ?</label>
          <p class="form-hint">Vous pouvez en s√©lectionner plusieurs</p>
          <div class="options-container" data-multiple="true">
            <%= f.hidden_field :source_stress, value: "[]" %>
            <% User::SOURCES_STRESS.each do |option| %>
              <button type="button" class="option-btn" data-value="<%= option %>" data-action="click->onboarding#selectOption">
                <%= option %>
              </button>
            <% end %>
          </div>
        </div>
      </div>
    </div>

    <!-- √âTAPE 4: Contexte de vie -->
    <div class="onboarding-step d-none" data-onboarding-target="step">
      <div class="step-icon">
        <i class="bi bi-house-heart"></i>
      </div>
      <h2 class="step-title">Votre contexte de vie</h2>
      <p class="step-subtitle">Votre situation actuelle influence vos r√™ves</p>

      <div class="step-content">
        <div class="form-group">
          <label class="onboarding-label">Quelle est votre situation professionnelle ?</label>
          <div class="options-container" data-multiple="false">
            <%= f.hidden_field :situation_pro %>
            <% User::SITUATIONS_PRO.each do |option| %>
              <button type="button" class="option-btn" data-value="<%= option %>" data-action="click->onboarding#selectOption">
                <%= option %>
              </button>
            <% end %>
          </div>
        </div>

        <div class="form-group">
          <label class="onboarding-label">Quelle est votre situation affective ?</label>
          <div class="options-container" data-multiple="false">
            <%= f.hidden_field :relationship_status %>
            <% User::SITUATIONS_AFFECTIVES.each do |option| %>
              <button type="button" class="option-btn" data-value="<%= option %>" data-action="click->onboarding#selectOption">
                <%= option %>
              </button>
            <% end %>
          </div>
        </div>

        <div class="form-group">
          <label class="onboarding-label">Avez-vous v√©cu des changements importants r√©cemment ?</label>
          <p class="form-hint">Vous pouvez en s√©lectionner plusieurs</p>
          <div class="options-container" data-multiple="true">
            <%= f.hidden_field :changements_recents, value: "[]" %>
            <% User::CHANGEMENTS_OPTIONS.each do |option| %>
              <button type="button" class="option-btn" data-value="<%= option %>" data-action="click->onboarding#selectOption">
                <%= option %>
              </button>
            <% end %>
          </div>
        </div>
      </div>
    </div>

    <!-- √âTAPE 5: Rapport aux r√™ves et symbolisme -->
    <div class="onboarding-step d-none" data-onboarding-target="step">
      <div class="step-icon">
        <i class="bi bi-stars"></i>
      </div>
      <h2 class="step-title">Votre vision des r√™ves</h2>
      <p class="step-subtitle">Votre rapport au symbolisme et √† l'inconscient</p>

      <div class="step-content">
        <div class="form-group">
          <label class="onboarding-label">Quel est votre rapport au symbolisme ?</label>
          <div class="options-container" data-multiple="false">
            <%= f.hidden_field :symbolisme %>
            <% User::SYMBOLISME_OPTIONS.each do |option| %>
              <button type="button" class="option-btn" data-value="<%= option %>" data-action="click->onboarding#selectOption">
                <%= option %>
              </button>
            <% end %>
          </div>
        </div>

        <div class="form-group">
          <label class="onboarding-label">Comment voyez-vous vos r√™ves ?</label>
          <div class="options-container" data-multiple="false">
            <%= f.hidden_field :vision_reves %>
            <% User::VISION_REVES_OPTIONS.each do |option| %>
              <button type="button" class="option-btn" data-value="<%= option %>" data-action="click->onboarding#selectOption">
                <%= option %>
              </button>
            <% end %>
          </div>
        </div>

        <div class="form-group">
          <label class="onboarding-label">Quelles sont vos principales peurs ?</label>
          <%= f.text_area :peurs_principales, class: "onboarding-textarea", placeholder: "D√©crivez librement vos peurs principales...", rows: 3 %>
        </div>

        <div class="form-group">
          <label class="onboarding-label">Quelles √©motions reviennent le plus souvent dans vos r√™ves ?</label>
          <%= f.text_area :emotions_recurrentes, class: "onboarding-textarea", placeholder: "Ex: peur, joie, confusion, nostalgie...", rows: 3 %>
        </div>
      </div>
    </div>

    <!-- √âTAPE 6: Pr√©f√©rences d'analyse -->
    <div class="onboarding-step d-none" data-onboarding-target="step">
      <div class="step-icon">
        <i class="bi bi-sliders"></i>
      </div>
      <h2 class="step-title">Vos pr√©f√©rences</h2>
      <p class="step-subtitle">Personnalisez le style de vos analyses</p>

      <div class="step-content">
        <div class="form-group">
          <label class="onboarding-label">Quel ton pr√©f√©rez-vous pour les analyses ?</label>
          <div class="options-container" data-multiple="false">
            <%= f.hidden_field :ton_prefere %>
            <% User::TONS_PREFERES.each do |option| %>
              <button type="button" class="option-btn" data-value="<%= option %>" data-action="click->onboarding#selectOption">
                <%= option %>
              </button>
            <% end %>
          </div>
        </div>

        <div class="form-group">
          <label class="onboarding-label">Quelle longueur d'analyse pr√©f√©rez-vous ?</label>
          <div class="options-container" data-multiple="false">
            <%= f.hidden_field :longueur_analyse %>
            <% User::LONGUEURS_ANALYSE.each do |option| %>
              <button type="button" class="option-btn" data-value="<%= option %>" data-action="click->onboarding#selectOption">
                <%= option %>
              </button>
            <% end %>
          </div>
        </div>

        <div class="form-group">
          <label class="onboarding-label">Quel style d'analyse pr√©f√©rez-vous ?</label>
          <div class="options-container" data-multiple="false">
            <%= f.hidden_field :style_prefere %>
            <% User::STYLES_ANALYSE.each do |option| %>
              <button type="button" class="option-btn" data-value="<%= option %>" data-action="click->onboarding#selectOption">
                <%= option %>
              </button>
            <% end %>
          </div>
        </div>

        <div class="completion-message">
          <i class="bi bi-check-circle"></i>
          <p>Parfait ! Vous √™tes pr√™t¬∑e √† explorer vos r√™ves.</p>
        </div>
      </div>
    </div>

    <!-- Navigation -->
    <div class="onboarding-navigation">
      <button type="button" class="btn btn-onboarding-prev d-none" data-onboarding-target="prevBtn" data-action="click->onboarding#prev">
        <i class="bi bi-arrow-left"></i> Pr√©c√©dent
      </button>
      <button type="button" class="btn btn-onboarding-next" data-onboarding-target="nextBtn" data-action="click->onboarding#next">
        Suivant <i class="bi bi-arrow-right"></i>
      </button>
      <%= f.submit "Commencer l'aventure", class: "btn btn-onboarding-submit d-none", data: { onboarding_target: "submitBtn" } %>
    </div>
  <% end %>
</div>
