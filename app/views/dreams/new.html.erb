<div class="container">
  <div class="row justify-content-center">
    <div class="col-lg-8">
      <div class="mystic-hero">
        <h1><i class="bi bi-stars"></i> Nouveau Rêve</h1>
        <p>Décrivez votre rêve avec le plus de détails possible</p>
      </div>

      <div class="mystic-card position-relative" data-controller="loading">
        <%= form_with model: @dream, class: "mystic-form" do |f| %>
          <div class="mb-3">
            <%= f.label :title, "Titre du rêve", class: "form-label" %>
            <%= f.text_field :title, class: "form-control", placeholder: "Donnez un titre à votre rêve..." %>
            <% if @dream.errors[:title].any? %>
              <div class="text-danger mt-1"><%= @dream.errors[:title].first %></div>
            <% end %>
          </div>

          <div class="mb-3">
            <%= f.label :date, "Date du rêve", class: "form-label" %>
            <%= f.date_field :date, class: "form-control" %>
            <% if @dream.errors[:date].any? %>
              <div class="text-danger mt-1"><%= @dream.errors[:date].first %></div>
            <% end %>
          </div>

          <div class="mb-4">
            <%= f.label :content, "Décrivez votre rêve en détail", class: "form-label" %>
            <%= f.text_area :content, class: "form-control", placeholder: "Décrivez votre rêve avec le plus de détails possible. Incluez les lieux, les personnes, les actions, les émotions ressenties, les couleurs, les sons... Plus vous êtes détaillé, plus l'analyse sera précise.", rows: 10 %>
            <% if @dream.errors[:content].any? %>
              <div class="text-danger mt-1"><%= @dream.errors[:content].first %></div>
            <% end %>
          </div>

          <div class="d-flex justify-content-between">
            <%= link_to "Annuler", dreams_path, class: "btn btn-mystic-secondary" %>
            <%= f.submit "Analyser mon rêve", class: "btn btn-mystic btn-lg", data: { loading_target: "button" } %>
          </div>
        <% end %>

        <!-- Overlay de chargement -->
        <div class="loading-overlay d-none" data-loading-target="overlay">
          <div class="loading-spinner-container" data-loading-target="spinner">
            <div class="mystic-spinner">
              <div class="spinner-ring"></div>
              <div class="spinner-ring"></div>
              <div class="spinner-ring"></div>
            </div>
            <p class="loading-text">
              <i class="bi bi-stars"></i><br>
              L'IA analyse votre rêve...<br>
              <small>Plongez dans les mystères de votre inconscient</small>
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
